负载均衡器位于端口 3000

worker 运行在 3001-3004 端口

用户访问 5173 端口（前端所在端口 -> 向 3000 端口发送请求 -> 负载均衡器 -> worker）



# =========== powershell 中测试的方法例子 ===========

# 测试负载均衡器
Invoke-RestMethod -Uri "http://localhost:3000/api/health"

# 测试所有工作进程 worker
1..4 | ForEach-Object {
    $port = 3000 + $_
    Write-Host "测试 Worker $_ (端口: $port)..."      
    try {
        # Invoke-RestMethod 会自动解析JSON，不需要ConvertFrom-Json
        $response = Invoke-RestMethod -Uri "http://localhost:$port/api/health"
        Write-Host "  ✅ 正常: Worker $($response.workerId), 端口: $($response.port)" -ForegroundColor Green   
    } catch {
        Write-Host "  ❌ 失败: $_" -ForegroundColor Red
    }
}

# 测试多用户同时输入请求的情况 六个用户的情况
$users = @(
    "user-alice-123",
    "user-bob-456", 
    "user-charlie-789"
    "user-charlie-789"
    "user-web-666"
    "user-ben-222"
)

foreach ($user in $users) {
    Write-Host "用户: $user 发送请求..." -ForegroundColor Yellow
    
    $response = Invoke-RestMethod -Uri "http://localhost:3000/api/health" `
        -Headers @{ "X-User-ID" = $user }
    
    Write-Host "  分配到: Worker $($response.workerId)" -ForegroundColor Green
    Write-Host ""
    
    Start-Sleep -Milliseconds 300
}


