# Whisper éŸ³é¢‘è½¬æ–‡å­—æœåŠ¡

åŸºäº OpenAI Whisper çš„éŸ³é¢‘è½¬æ–‡å­—æœåŠ¡ï¼Œæ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ™ï¸ æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ï¼šMP3, WAV, MP4, M4A, OGG, WebM
- ğŸŒ æ”¯æŒå¤šè¯­è¨€è¯†åˆ«ï¼ˆé»˜è®¤ä¸­æ–‡ï¼‰
- ğŸ”„ è‡ªåŠ¨ç¹ç®€è½¬æ¢ï¼ˆè¾“å‡ºç®€ä½“ä¸­æ–‡ï¼‰
- âš¡ æœ¬åœ°è¿è¡Œï¼Œä¿æŠ¤éšç§
- ğŸ“Š è¿”å›æ—¶é—´è½´åˆ†æ®µä¿¡æ¯

## ç¯å¢ƒè¦æ±‚

- Python 3.10+
- ï¼ˆå¯é€‰ï¼‰Anaconda/Miniconda
- è‡³å°‘ 2GB å¯ç”¨ç£ç›˜ç©ºé—´ï¼ˆç”¨äºæ¨¡å‹ï¼‰

## å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Python venvï¼ˆæ¨èï¼Œæ— éœ€ Anacondaï¼‰

#### Windows

```powershell
# 1. å®‰è£…ç¯å¢ƒ
.\setup-venv.ps1

# 2. å¯åŠ¨æœåŠ¡
.\start-whisper-venv.ps1
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Condaï¼ˆéœ€è¦å®‰è£… Anaconda/Minicondaï¼‰

#### Windows

```powershell
# 1. å®‰è£…ç¯å¢ƒ
.\setup.ps1

# 2. å¯åŠ¨æœåŠ¡
.\start-whisper.ps1
```

### Linux/macOS

```bash
# 1. å®‰è£…ç¯å¢ƒ
chmod +x setup.sh
./setup.sh

# 2. å¯åŠ¨æœåŠ¡
chmod +x start-whisper.sh
./start-whisper.sh
```

## API æ¥å£

### 1. å¥åº·æ£€æŸ¥

```http
GET http://localhost:5000/api/health
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "healthy",
  "service": "whisper-transcription",
  "model": "base"
}
```

### 2. éŸ³é¢‘è½¬æ–‡å­—

```http
POST http://localhost:5000/api/transcribe
Content-Type: multipart/form-data
```

**å‚æ•°ï¼š**
- `audio` (file, required): éŸ³é¢‘æ–‡ä»¶
- `language` (string, optional): è¯­è¨€ä»£ç ï¼Œé»˜è®¤ "zh"ï¼ˆä¸­æ–‡ï¼‰ï¼Œå¯é€‰ "auto"ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "text": "è¿™æ˜¯è½¬å½•çš„å®Œæ•´æ–‡æœ¬",
  "language": "zh",
  "segments": [
    {
      "start": 0.0,
      "end": 3.5,
      "text": "è¿™æ˜¯ç¬¬ä¸€æ®µ"
    },
    {
      "start": 3.5,
      "end": 7.0,
      "text": "è¿™æ˜¯ç¬¬äºŒæ®µ"
    }
  ]
}
```

## æ¨¡å‹é€‰æ‹©

åœ¨ `app.py` ä¸­å¯ä»¥æ›´æ”¹æ¨¡å‹å¤§å°ï¼š

```python
model = whisper.load_model("base")  # å¯é€‰ï¼štiny, base, small, medium, large
```

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | å‡†ç¡®åº¦ |
|------|------|------|--------|
| tiny | 39 MB | æœ€å¿« | è¾ƒä½ |
| base | 74 MB | å¿« | ä¸­ç­‰ |
| small | 244 MB | ä¸­ç­‰ | è¾ƒå¥½ |
| medium | 769 MB | æ…¢ | å¥½ |
| large | 1550 MB | æœ€æ…¢ | æœ€å¥½ |

æ¨èä½¿ç”¨ `base` æ¨¡å‹ï¼Œåœ¨é€Ÿåº¦å’Œå‡†ç¡®åº¦ä¹‹é—´å–å¾—è‰¯å¥½å¹³è¡¡ã€‚

## æ•…éšœæ’é™¤

### 1. æ‰¾ä¸åˆ° Python å‘½ä»¤
ç¡®ä¿å·²å®‰è£… Python 3.10+ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ã€‚
ä¸‹è½½åœ°å€ï¼šhttps://www.python.org/downloads/

### 2. æ‰¾ä¸åˆ° Conda å‘½ä»¤
å¦‚æœä½¿ç”¨ venv æ–¹æ³•ï¼Œæ— éœ€å®‰è£… Condaã€‚ä½¿ç”¨ `.\setup-venv.ps1` å’Œ `.\start-whisper-venv.ps1`ã€‚

### 3. ç«¯å£è¢«å ç”¨
ä¿®æ”¹ `app.py` ä¸­çš„ç«¯å£å·ï¼Œæˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
PORT=5001 python app.py
```

### 3. æ¨¡å‹ä¸‹è½½æ…¢
é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½æ¨¡å‹ï¼Œå¦‚ç½‘ç»œæ…¢å¯æ‰‹åŠ¨ä¸‹è½½åæ”¾åˆ° `~/.cache/whisper/` ç›®å½•ã€‚

## æŠ€æœ¯æ ˆ

- Flask - Web æ¡†æ¶
- OpenAI Whisper - è¯­éŸ³è¯†åˆ«
- zhconv - ç¹ç®€è½¬æ¢
- PyTorch - æ·±åº¦å­¦ä¹ æ¡†æ¶

## æ³¨æ„äº‹é¡¹

1. é¦–æ¬¡è¿è¡Œä¼šä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼ˆbase çº¦ 142MBï¼‰
2. å¤„ç†è¾ƒå¤§éŸ³é¢‘æ–‡ä»¶æ—¶å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
3. æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ http://localhost:5000
4. å»ºè®®ä½¿ç”¨ GPU ä»¥æå‡å¤„ç†é€Ÿåº¦ï¼ˆéœ€é…ç½® CUDAï¼‰
